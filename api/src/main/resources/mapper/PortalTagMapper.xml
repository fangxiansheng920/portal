<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.icheer.portal.mapper.PortalTagMapper">

    <!-- 获取该站点的标签id集合 -->
    <select id="getPortalTagIdSet" resultType="java.lang.Long">
        select tag_id
        from portal_tag
        where portal_id = #{portalId}
    </select>

    <!-- 添加站点标签关联 -->
    <insert id="addPortalTag">
        insert into portal_tag (portal_id, tag_id, create_time)
        values
        <foreach collection="tagIdSet" item="tagId" separator=",">
            (#{portalId}, #{tagId}, now())
        </foreach>
    </insert>

    <!-- 删除站点标签关联 -->
    <delete id="deletePortalTag">
        delete
        from portal_tag
        where portal_id = #{portalId}
        and tag_id in
        <foreach collection="tagIdSet" item="tagId" open="(" close=")" separator=",">
            #{tagId}
        </foreach>
    </delete>

    <!-- 通过站点id删除站点标签关联 -->
    <delete id="deletePortalTagByPortalId">
        delete
        from portal_tag
        where portal_id = #{portalId}
    </delete>

    <!-- 删除站点标签关联 -->
    <delete id="deleteTagPortal">
        delete
        from portal_tag
        where tag_id = #{tagId}
    </delete>

</mapper>